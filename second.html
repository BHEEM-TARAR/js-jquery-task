<!doctype html>
<html>

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.rtl.min.css"
    integrity="sha384-DOXMLfHhQkvFFp+rWTZwVlPVqdIhpDVYT9csOnHSgWQWPX0v5MCGtjCJbY6ERspU" crossorigin="anonymous">
</head>

<body>

  <div class="row mt-5">
    <div class="col-4 text-center">
      <!-- Button trigger modal -->
      <button type="button" class="btn btn-primary btn-lg" data-bs-toggle="modal" data-bs-target="#heading">
        Heading
      </button>
    </div>
    <div class="col-4 text-center">
      <!-- Button trigger modal -->
      <button type="button" class="btn btn-danger btn-lg" data-bs-toggle="modal" data-bs-target="#subheading">
        Subheading
      </button>
    </div>
    <div class="col-4 text-center">
      <!-- Button trigger modal -->
      <button type="button" class="btn btn-info btn-lg" data-bs-toggle="modal" data-bs-target="#form">
        Form
      </button>
    </div>
  </div>
  <hr>
  <main></main>

  <!-- Modal first 1 -->
  <div class="modal fade" id="heading" tabindex="-1" aria-labelledby="headingLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="headingLabel">Heading</h1>
        </div>
        <form method="post" id="heading-form">
          <div class="modal-body">
            <label>Enter Heading</label>
            <input type="text" class="form-control input-heading" value="" placeholder="Enter Heading">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary" id="heading-btn">Save changes</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Modal second 2 -->
  <div class="modal fade" id="subheading" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Subheading Title</h1>
        </div>
        <form method="post" id="subheading-form">
          <div class="modal-body">
            <label>Enter Heading</label>
            <select class="form-control heading-select" aria-label="Default select example" id="sub-select"
              name="heading-form">
              <option selected></option>
            </select>
            <label>Enter Subheading</label>
            <input type="text" id="sub-input" class="form-control input-subheading" value=""
              placeholder="Enter Subheading">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary" id="subheading-btn">Save changes</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Modal third for modal-->
  <div class="modal fade" id="form" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Form</h1>
        </div>
        <form id="sample-Form" method="post">
          <div class="modal-body">
            <label>Heading</label>
            <select class="form-control mt-2" aria-label="Default select example" id="selectfield"
              name="sub-heading-form">
              <option value="" disabled selected>Choose a header</option>
            </select>
          </div>
          <div class="modal-body">
            <label>Subheading</label>
            <select class="form-control mt-2" aria-label="Default select example" id="subheadselect"
              name="sub-heading2">
              <option value="" disabled selected>Choose a header</option>
            </select>
            <div class="modal-body">
              <label>Select Fields</label>
              <select class="form-control mt-2" id="input" aria-label="Default select example" id="fields1">
                <option value="" disabled selected>Choose an input-type</option>
                <option value="text">Text</option>
                <option value="textarea">Textarea</option>
                <option value="file">File</option>
                <option value="email">Email</option>
                <option value="option">Option</option>
                <option value="submit">Submit</option>
                <option value="checkbox">Checkbox</option>
              </select>
              <div class="form-group">
                <label for="name" class="col-form-label">Name:</label>
                <input type="text" class="form-control" id="name" name="name" placeholder="Enter a name">
              </div>
              <div class="form-group">
                <label for="class" class="col-form-label">Class:</label>
                <input type="text" class="form-control" id="class" name="class" placeholder="Enter the class">
              </div>
              <div class="form-group">
                <label for="value" class="col-form-label">Value:</label>
                <input type="text" class="form-control" id="value" name="value" placeholder="Enter the value">
              </div>
              <div class="form-group">
                <label for="placeholder" class="col-form-label">Placeholder:</label>
                <input type="text" class="form-control" id="placeholder" name="placeholder"
                  placeholder="Enter the placeholder">
              </div>
              <div class="form-group">
                <label for="options" class="col-form-label">Options:</label>
                <input type="text" class="form-control" id="options" name="options"
                  placeholder="Enter options (comma separated)">
              </div>
              <div class="form-group form-check">
                <input type="checkbox" class="form-check-input" id="readonly" name="selectoption">
                <label class="form-check-label" for="readonly"> Readonly</label>
              </div>
              <div class="form-group form-check">
                <input type="checkbox" class="form-check-input" id="disabled" name="selectoption">
                <label class="form-check-label" for="disabled"> Disable</label>
              </div>
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-primary">Submit</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Optional JavaScript; choose one of the two! -->
  <script src="https://code.jquery.com/jquery-3.7.1.slim.js"
    integrity="sha256-UgvvN8vBkgO0luPSUl2s8TIlOSYRoGFAX4jlCIm9Adc=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
    crossorigin="anonymous"></script>
<script>
$(document).ready(function () {
    // Load data from localStorage on page load
    loadDataFromLocalStorage();

    // Save new heading
    $('#heading-form').on('submit', function (e) {
        e.preventDefault();
        var newHeading = $('.input-heading').val().trim();
        if (newHeading) {
            $('#heading').modal('hide');
            $('#selectfield').append(`<option>${newHeading}</option>`);
            $('#sub-select').append(`<option>${newHeading}</option>`);
            // Append new heading to the list
            $('main').append(`<div class="heading-container"><h1>${newHeading}</h1><div class="subheading-list"></div></div>`);
            // Save data to localStorage
            saveDataToLocalStorage();
            // Clear input field
            $('.input-heading').val('');
        }
    });

    // Save new subheading
    $('#subheading-form').on('submit', function (e) {
        e.preventDefault();
        var selectedHeading = $('#sub-select').val();
        var newSubHeading = $('#sub-input').val().trim();
        if (selectedHeading && newSubHeading) {
            $('#subheading').modal('hide');
            var headingContainer = $(`.heading-container:has(h1:contains('${selectedHeading}'))`);
            headingContainer.find('.subheading-list').append(`<div class="subheading-container"><h2>${newSubHeading}</h2><div class="form-list"></div></div>`);
            $('#subheadselect').append(`<option>${newSubHeading}</option>`);
            // Save data to localStorage
            saveDataToLocalStorage();
            // Clear input fields
            $('#sub-input').val('');
        }
    });

    // Save new form
    $('#sample-Form').on('submit', function (e) {
        e.preventDefault();
        var selectHeading = $('#selectfield').val();
        var selectSubHeading = $('#subheadselect').val();
        var inputType = $('#input').val();
        var nameInput = $('#name').val();
        var classInput = $('#class').val();
        var valueInput = $('#value').val();
        var placeholderInput = $('#placeholder').val();
        var optionInput = $('#options').val();
        var isReadonly = $('#readonly').is(':checked');
        var isDisabled = $('#disabled').is(':checked');
        var inputTag = '';

        switch (inputType) {
            case 'text':
            case 'email':
            case 'file':
                inputTag = `<input type="${inputType}" id="${nameInput}" class="${classInput}" name="${nameInput}" value="${valueInput}" placeholder="${placeholderInput}" ${isReadonly ? 'readonly' : ''} ${isDisabled ? 'disabled' : ''}>`;
                break;
            case 'textarea':
                inputTag = `<textarea id="${nameInput}" class="${classInput}" name="${nameInput}" placeholder="${placeholderInput}" ${isReadonly ? 'readonly' : ''} ${isDisabled ? 'disabled' : ''}>${valueInput}</textarea>`;
                break;
            case 'checkbox':
            case 'radio':
                optionInput.split(',').forEach(option => {
                    inputTag += `<label><input type="${inputType}" id="${option.trim()}" class="${classInput}" name="${nameInput}" value="${option.trim()}" ${isReadonly ? 'readonly' : ''} ${isDisabled ? 'disabled' : ''}> ${option.trim()}</label>`;
                });
                break;
            case 'select':
                inputTag = `<select id="${nameInput}" class="${classInput}" name="${nameInput}" ${isReadonly ? 'readonly' : ''} ${isDisabled ? 'disabled' : ''}>`;
                optionInput.split(',').forEach(option => {
                    inputTag += `<option value="${option.trim()}">${option.trim()}</option>`;
                });
                inputTag += `</select>`;
                break;
            case 'submit':
                inputTag = `<input type="submit" id="${nameInput}" class="${classInput}" value="${valueInput}">`;
                break;
        }

        var subHeadingContainer = $(`.heading-container:has(h1:contains('${selectHeading}')) .subheading-container:has(h2:contains('${selectSubHeading}')) .form-list`);
        subHeadingContainer.append(inputTag);
        $('#form').modal('hide');

        // Save data to localStorage
        saveDataToLocalStorage();

        // Clear input fields
        $('#sample-Form')[0].reset();
    });

    // Handle close button click for headings
    $('main').on('click', '.close1', function () {
        $(this).closest('.heading-container').remove();
        saveDataToLocalStorage();
    });

    // Save data to localStorage
    function saveDataToLocalStorage() {
        var data = [];
        $('.heading-container').each(function () {
            var heading = $(this).find('h1').text().trim();
            var subHeadings = [];
            $(this).find('.subheading-container').each(function () {
                var subHeading = $(this).find('h2').text().trim();
                var formElements = $(this).find('.form-list').html();
                subHeadings.push({
                    subHeading: subHeading,
                    formElements: formElements
                });
            });
            data.push({
                heading: heading,
                subHeadings: subHeadings
            });
        });
        localStorage.setItem('formData', JSON.stringify(data));
    }

    // Load data from localStorage
    function loadDataFromLocalStorage() {
        var data = JSON.parse(localStorage.getItem('formData'));
        if (data) {
            data.forEach(function (headingData) {
                var headingContainer = $(`<div class="heading-container"><h1>${headingData.heading}</h1><div class="subheading-list"></div></div>`);
                $('#selectfield').append(`<option>${headingData.heading}</option>`);
                $('#sub-select').append(`<option>${headingData.heading}</option>`);
                headingData.subHeadings.forEach(function (subHeadingData) {
                    var subHeadingContainer = $(`<div class="subheading-container"><h2>${subHeadingData.subHeading}</h2><div class="form-list">${subHeadingData.formElements}</div></div>`);
                    headingContainer.find('.subheading-list').append(subHeadingContainer);
                    $('#subheadselect').append(`<option>${subHeadingData.subHeading}</option>`);
                });
                $('main').append(headingContainer);
            });
        }
    }

    // Enable drag-and-drop reordering
    $('main').sortable({
        items: '.heading-container',
        update: function (event, ui) {
            saveDataToLocalStorage();
        }
    });

    $('.subheading-list').sortable({
        items: '.subheading-container',
        update: function (event, ui) {
            saveDataToLocalStorage();
        }
    });
});


</script>







</body>

</html>

$('#selectfield').change(function () {
  var selectedHeading = $(this).val();
  var subHeadings = $(`.heading-container:has(h1:contains('${selectedHeading}')) .subheading-container h2`);
  $('#subheadselect').empty().append('<option value="" disabled selected>Choose a sub-heading</option>');
  subHeadings.each(function () {
      var subHeadingText = $(this).text();
      $('#subheadselect').append(`<option>${subHeadingText}</option>`);
  });
});

function saveDataToLocalStorage() {
  var data = [];
  $('.heading-container').each(function () {
      var heading = $(this).find('h1').text().trim();
      var subHeadings = [];
      $(this).find('.subheading-container').each(function () {
          var subHeading = $(this).find('h2').text().trim();
          var formElements = $(this).find('.form-list').html();
          subHeadings.push({
              subHeading: subHeading,
              formElements: formElements
          });
      });
      data.push({
          heading: heading,
          subHeadings: subHeadings
      });
  });
  localStorage.setItem('formData', JSON.stringify(data));
}

function loadDataFromLocalStorage() {
  var data = JSON.parse(localStorage.getItem('formData'));
  if (data) {
      data.forEach(function (headingData) {
          var headingContainer = $(`<div class="heading-container"><h1>${headingData.heading}<button type="button" class="close1" aria-label="Close"><span aria-hidden="true">&times;</span></button></h1><div class="subheading-list"></div></div>`);
          $('#selectfield').append(`<option>${headingData.heading}</option>`);
          $('#sub-select').append(`<option>${headingData.heading}</option>`);
          headingData.subHeadings.forEach(function (subHeadingData) {
              var subHeadingContainer = $(`<div class="subheading-container"><h2>${subHeadingData.subHeading}<button type="button" class="close-heading-btn" aria-label="Close"><span aria-hidden="true">&times;</span></button></h2><div class="form-list">${subHeadingData.formElements}</div></div>`);
              headingContainer.find('.subheading-list').append(subHeadingContainer);
              $('#subheadselect').append(`<option>${subHeadingData.subHeading}</option>`);
          });
          $('main').append(headingContainer);
      });
  }
}
});



